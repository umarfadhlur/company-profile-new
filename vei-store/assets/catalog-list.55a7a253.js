import{d as J,u as j,r as n,k as A,o as O,b as l,c as i,e as t,G as x,R as Q,S as W,a4 as N,F as $,y as F,t as c,g as X,l as k,aV as Y,B as Z}from"./index.ad8d3253.js";import{I as ee}from"./icon-loader.0d7c22e0.js";const te={class:"p-6"},ae={class:"flex flex-wrap gap-4 mb-6"},se={class:"flex items-center gap-2"},oe=["onKeyup"],ne=t("option",{value:""},"Semua Kategori",-1),le=["value"],ie=t("option",{value:""},"Semua Fandom",-1),ce=["value"],re={key:0,class:"text-center py-8"},de={key:1,class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 mb-6"},ue=["src"],ve={class:"font-bold text-lg mb-1"},me={class:"text-gray-500 mb-1"},ge={class:"text-primary font-semibold mb-1"},pe={class:"text-xs mb-2"},_e=["disabled","onClick"],fe={class:"flex items-center justify-between mt-4"},he={class:"flex items-center gap-3"},be=["disabled"],ye=["disabled"],xe={class:"flex items-center gap-3"},ke=t("div",{class:"text-sm text-gray-600"},"Tampilkan",-1),we=t("option",{value:8},"8",-1),Ce=t("option",{value:12},"12",-1),Se=t("option",{value:24},"24",-1),Pe=[we,Ce,Se],Ve={key:0,class:"ml-3"},Be=t("svg",{class:"w-5 h-5 animate-spin text-gray-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})],-1),Me=[Be],Ke=J({__name:"catalog-list",setup(Ne){const w=j(),p=n([]),C=n([]),S=n([]),_=n(""),h=n(""),b=n(""),r=n(1),v=n(12),P=n(0),m=n(!1),E=s=>s?"Rp "+Number(s).toLocaleString("id-ID"):"-",H=A(()=>p.value),q=async s=>{await j().post("/api/cart",{product_id:s.id,quantity:1})},z=async()=>{var a,e,o;const s=await w.get("/api/category");C.value=(o=(e=(a=s.data)==null?void 0:a.data)!=null?e:s.data)!=null?o:[]},G=async()=>{var a,e,o;const s=await w.get("/api/fandom");S.value=(o=(e=(a=s.data)==null?void 0:a.data)!=null?e:s.data)!=null?o:[]},K=async(s=1)=>{var a,e,o,f,B,D,L,T,I,R;m.value=!0;try{const g={page:s,per_page:v.value};if(_.value&&String(_.value).trim()!==""&&(g.product=_.value.trim()),h.value){const u=C.value.find(M=>String(M.id)===String(h.value));u&&u.name&&(g.category=u.name)}if(b.value){const u=S.value.find(M=>String(M.id)===String(b.value));u&&u.name&&(g.fandom=u.name)}const d=await w.get("/api/product",{params:g});(a=d.data)!=null&&a.data?(p.value=d.data.data,P.value=(f=(o=(e=d.data.meta)==null?void 0:e.total)!=null?o:d.data.total)!=null?f:p.value.length,r.value=(L=(D=(B=d.data.meta)==null?void 0:B.current_page)!=null?D:d.data.current_page)!=null?L:s,v.value=(I=(T=d.data.meta)==null?void 0:T.per_page)!=null?I:v.value):(p.value=(R=d.data)!=null?R:[],P.value=p.value.length,r.value=s)}catch(g){console.error("fetch products error",g)}finally{m.value=!1}},y=s=>{s<1||s>V.value||K(s)},V=A(()=>Math.max(1,Math.ceil((P.value||0)/v.value))),U=()=>{y(1)};return O(()=>{z(),G(),K(r.value)}),(s,a)=>(l(),i("div",te,[t("div",ae,[t("div",se,[x(t("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>_.value=e),onKeyup:W(U,["enter"]),placeholder:"Cari produk...",class:"form-input w-64"},null,40,oe),[[Q,_.value]])]),x(t("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>h.value=e),class:"form-input"},[ne,(l(!0),i($,null,F(C.value,e=>(l(),i("option",{key:e.id,value:e.id},c(e.name),9,le))),128))],512),[[N,h.value]]),x(t("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>b.value=e),class:"form-input"},[ie,(l(!0),i($,null,F(S.value,e=>(l(),i("option",{key:e.id,value:e.id},c(e.name),9,ce))),128))],512),[[N,b.value]]),t("button",{class:"btn btn-primary",onClick:U},"Search")]),m.value?(l(),i("div",re,[X(ee,{class:"w-8 h-8 text-gray-500 m-auto"})])):(l(),i("div",de,[(l(!0),i($,null,F(k(H),e=>{var o,f;return l(),i("div",{key:e.id,class:"bg-white rounded-lg shadow p-4 flex flex-col items-center"},[t("img",{src:`${k(Y)}/public/storage/${e.image_url}`,alt:"Produk",class:"w-32 h-32 object-cover rounded mb-2"},null,8,ue),t("div",ve,c(e.name),1),t("div",me,c(((o=e.category)==null?void 0:o.name)||"-")+" | "+c(((f=e.fandom)==null?void 0:f.name)||"-"),1),t("div",ge,c(E(e.price)),1),t("div",pe,"Stok: "+c(e.stock),1),t("button",{class:"btn btn-success w-full",disabled:e.stock<1,onClick:B=>q(e)},"Tambah ke Cart",8,_e)])}),128))])),t("div",fe,[t("div",he,[t("button",{class:"btn btn-secondary btn-sm",disabled:r.value===1||m.value,onClick:a[3]||(a[3]=e=>y(r.value-1))},"Prev",8,be),t("span",null,"Halaman "+c(r.value)+" / "+c(k(V)),1),t("button",{class:"btn btn-secondary btn-sm",disabled:r.value===k(V)||m.value,onClick:a[4]||(a[4]=e=>y(r.value+1))},"Next",8,ye)]),t("div",xe,[ke,x(t("select",{"onUpdate:modelValue":a[5]||(a[5]=e=>v.value=e),onChange:a[6]||(a[6]=e=>y(1)),class:"form-input"},Pe,544),[[N,v.value,void 0,{number:!0}]]),m.value?(l(),i("div",Ve,Me)):Z("",!0)])])]))}});export{Ke as default};
