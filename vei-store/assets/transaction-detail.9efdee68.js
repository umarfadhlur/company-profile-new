import{d as q,aU as M,aS as U,u as E,r as P,o as K,k as Q,b as p,c as _,e as t,t as n,x as z,F as W,y as G,B,f as H,l as J,aV as O,aP as X,aQ as Y,v as Z}from"./index.d37f362c.js";const w=m=>(X("data-v-9c2ffe7e"),m=m(),Y(),m),tt={class:"p-6"},et=w(()=>t("h2",{class:"text-2xl font-bold mb-4"},"Detail Transaksi",-1)),st={key:0,class:"text-center py-8"},at={key:1,class:"bg-white rounded-lg shadow p-3 mx-auto max-w-4xl"},ot={class:"mb-4 flex justify-between items-center"},nt={class:"font-semibold text-lg"},ct={class:"text-sm text-gray-500"},dt={class:"text-right"},lt=w(()=>t("div",{class:"font-semibold"},"Status",-1)),rt={class:"table-auto w-full mb-4 mt-3"},it=w(()=>t("thead",{class:"bg-gray-100"},[t("tr",null,[t("th"),t("th",null,"Product"),t("th",null,"Price"),t("th",null,"Quantity"),t("th",null,"Total"),t("th",null,"Payment Method")])],-1)),ut={class:"px-4 py-2 align-top w-1/12"},pt=["src"],_t={class:"px-4 py-2 align-top w-3/12"},ht={class:"font-bold"},vt={class:"text-xs text-gray-500"},ft={class:"font-semibold"},gt={key:0,class:"text-xs text-gray-600 mt-1"},yt={class:"px-4 py-2 align-top font-bold w-3/12"},mt={class:"px-4 py-2 align-top w-2/12"},xt={class:"font-bold"},bt={class:"px-4 py-2 align-top font-bold w-2/12"},wt={class:"px-4 py-2 align-top font-bold w-2/12"},kt={class:"flex justify-end items-center mt-6 gap-6"},St={class:"text-right"},Ct=w(()=>t("div",{class:"text-sm text-gray-500"},"Subtotal",-1)),Pt={class:"font-bold text-lg"},Dt={key:2,class:"text-gray-500 text-center py-8"},Lt=q({__name:"transaction-detail",setup(m){const A=M(),I=U(),k=E(),l=P(null),a=P([]),x=P(!0),N=async s=>{var h,e,r,i;x.value=!0;try{const c=await k.get(`/api/transaction/${s}`),u=(e=(h=c.data)==null?void 0:h.data)!=null?e:c.data;if(l.value=u,a.value=Array.isArray(u==null?void 0:u.details)?u.details:[],a.value.some(d=>!d.product)){const d=[...new Set(a.value.filter(o=>!o.product).map(o=>o.product_id))],b=await Promise.all(d.map(o=>k.get(`/api/product/${o}`).then(g=>{var y,L;return(L=(y=g.data)==null?void 0:y.data)!=null?L:g.data}).catch(()=>null))),j=new Map(b.filter(Boolean).map(o=>[o.id,o]));a.value=a.value.map(o=>{var g,y;return{...o,product:(y=(g=o.product)!=null?g:j.get(o.product_id))!=null?y:null}})}const f=await k.get(`/api/payments/transaction/${l.value.id}`),v=(i=(r=f.data)==null?void 0:r.data)!=null?i:f.data;v&&v.length>0?a.value=a.value.map(d=>({...d,payment_method:v[0].method||"-"})):a.value=a.value.map(d=>({...d,payment_method:"-"}))}catch(c){console.error("fetch transaction error",c),l.value=null,a.value=[]}finally{x.value=!1}},D=A.params.id;K(()=>{D?N(D):x.value=!1});const S=s=>s==null?"-":"Rp "+Number(s).toLocaleString("id-ID"),R=s=>s?new Date(s).toLocaleString():"-",$=s=>s?s.startsWith("http")?s:`${O}/storage/${s}`:"",F=Q(()=>a.value.reduce((s,h)=>{var e,r,i,c;return s+((i=(r=(e=h.product)==null?void 0:e.price)!=null?r:h.price)!=null?i:0)*((c=h.quantity)!=null?c:0)},0)),T=s=>s?["paid","completed","success"].includes(String(s).toLowerCase())?"text-green-600":["pending","processing"].includes(String(s).toLowerCase())?"text-yellow-600":["canceled","failed"].includes(String(s).toLowerCase())?"text-red-600":"text-gray-600":"text-gray-600",V=()=>I.back();return(s,h)=>(p(),_("div",tt,[et,x.value?(p(),_("div",st,"Loading...")):l.value?(p(),_("div",at,[t("div",ot,[t("div",null,[t("div",nt,n(l.value.code||"#"+l.value.id),1),t("div",ct,n(R(l.value.created_at)),1)]),t("div",dt,[lt,t("div",{class:z(T(l.value.status))},n(l.value.status||"-"),3)])]),t("table",rt,[it,t("tbody",null,[(p(!0),_(W,null,G(a.value,e=>{var r,i,c,u,C,f,v,d,b;return p(),_("tr",{key:e.product_id||e.id,class:"align-top"},[t("td",ut,[(r=e.product)!=null&&r.image_url?(p(),_("img",{key:0,src:$(e.product.image_url),alt:"img",class:"w-16 h-16 object-cover rounded"},null,8,pt)):B("",!0)]),t("td",_t,[t("div",ht,n(e.product_name||e.product_name||"-"),1),t("div",vt,[H("Code: "),t("span",ft,n(((i=e.product)==null?void 0:i.code)||e.code||"-"),1)]),(c=e.product)!=null&&c.description?(p(),_("div",gt,n(e.product.description),1)):B("",!0)]),t("td",yt,n(S((C=(u=e.product)==null?void 0:u.price)!=null?C:e.price)),1),t("td",mt,[t("div",xt,n(e.quantity),1)]),t("td",bt,n(S(((d=(v=(f=e.product)==null?void 0:f.price)!=null?v:e.price)!=null?d:0)*((b=e.quantity)!=null?b:0))),1),t("td",wt,n(e.payment_method.toUpperCase()),1)])}),128))])]),t("div",kt,[t("div",St,[Ct,t("div",Pt,n(S(J(F))),1)]),t("button",{class:"btn btn-secondary",onClick:V},"Kembali")])])):(p(),_("div",Dt,"Data transaksi tidak ditemukan."))]))}});const At=Z(Lt,[["__scopeId","data-v-9c2ffe7e"]]);export{At as default};
