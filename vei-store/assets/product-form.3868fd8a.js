import{d as F,aU as N,aS as B,r as d,o as S,a as T,b as s,c as i,e,t as p,V as R,G as u,R as v,a4 as k,F as y,y as h,B as L,g as j,w as E,u as c,aV as K,f as M}from"./index.5985d42f.js";const $={class:"p-6 flex justify-center"},H={class:"bg-white rounded-lg shadow p-6 w-full max-w-xl"},A={class:"text-xl font-bold mb-4 text-primary"},G=["onSubmit"],I=e("label",{class:"block font-semibold mb-1"},"Nama",-1),O=e("label",{class:"block font-semibold mb-1"},"Deskripsi",-1),q=e("label",{class:"block font-semibold mb-1"},"Harga",-1),z=e("label",{class:"block font-semibold mb-1"},"Stok",-1),J=e("label",{class:"block font-semibold mb-1"},"Kategori",-1),Q=e("option",{value:""},"Pilih Kategori",-1),W=["value"],X=e("label",{class:"block font-semibold mb-1"},"Fandom",-1),Y=e("option",{value:""},"Pilih Fandom",-1),Z=["value"],ee=e("label",{class:"block font-semibold mb-1"},"Gambar",-1),ae={class:"flex items-center gap-4"},te=["src"],oe={key:1,class:"text-gray-400"},le={type:"submit",class:"btn btn-primary w-full mt-2"},ne=F({__name:"product-form",setup(se){const _=N(),w=B(),r=d(!!_.params.id),t=d({name:"",description:"",price:"",stock:"",category_id:"",fandom_id:"",image_url:""}),m=d(null),n=d(void 0),b=d([]),f=d([]),P=async()=>{var o,l;if(r.value){const a=(await c().get(`/api/product/${_.params.id}`)).data.data;t.value={name:a.name,description:a.description||"",price:a.price||"",stock:a.stock||"",category_id:((o=a.category)==null?void 0:o.id)||"",fandom_id:((l=a.fandom)==null?void 0:l.id)||"",image_url:a.image_url||""},t.value.image_url&&(n.value=`${K}/storage/${t.value.image_url}`)}},x=async()=>{const o=await c().get("/api/category");b.value=o.data.data},U=async()=>{const o=await c().get("/api/fandom");f.value=o.data.data},V=o=>{const l=o.target.files;l&&l[0]&&(m.value=l[0],n.value=URL.createObjectURL(l[0]))},C=()=>{m.value=null,n.value=void 0,t.value.image_url=""},D=async()=>{const o=new FormData;if(o.append("name",t.value.name||""),o.append("description",t.value.description||""),o.append("price",t.value.price||""),o.append("stock",t.value.stock||""),o.append("category_id",t.value.category_id||""),o.append("fandom_id",t.value.fandom_id||""),o.append("is_active","1"),m.value?o.append("image_url",m.value):t.value.image_url===""&&r.value&&o.append("remove_image","1"),!t.value.name||!t.value.category_id){alert("Nama produk dan kategori wajib diisi!");return}r.value?await c().post(`/api/product/${_.params.id}?_method=PUT`,o,{headers:{"Content-Type":"multipart/form-data"}}):await c().post("/api/product",o,{headers:{"Content-Type":"multipart/form-data"}}),w.push("/apps/product")};return S(()=>{P(),x(),U()}),(o,l)=>{const g=T("router-link");return s(),i("div",$,[e("div",H,[e("h2",A,p(r.value?"Edit Produk":"Tambah Produk Baru"),1),e("form",{onSubmit:R(D,["prevent"]),class:"space-y-4"},[e("div",null,[I,u(e("input",{"onUpdate:modelValue":l[0]||(l[0]=a=>t.value.name=a),placeholder:"Nama Produk",class:"form-input w-full"},null,512),[[v,t.value.name]])]),e("div",null,[O,u(e("input",{"onUpdate:modelValue":l[1]||(l[1]=a=>t.value.description=a),placeholder:"Deskripsi Produk",class:"form-input w-full"},null,512),[[v,t.value.description]])]),e("div",null,[q,u(e("input",{"onUpdate:modelValue":l[2]||(l[2]=a=>t.value.price=a),type:"number",min:"0",placeholder:"Harga Produk",class:"form-input w-full"},null,512),[[v,t.value.price]])]),e("div",null,[z,u(e("input",{"onUpdate:modelValue":l[3]||(l[3]=a=>t.value.stock=a),type:"number",min:"0",placeholder:"Stok Produk",class:"form-input w-full"},null,512),[[v,t.value.stock]])]),e("div",null,[J,u(e("select",{"onUpdate:modelValue":l[4]||(l[4]=a=>t.value.category_id=a),class:"form-input w-full"},[Q,(s(!0),i(y,null,h(b.value,a=>(s(),i("option",{key:a.id,value:a.id},p(a.name),9,W))),128))],512),[[k,t.value.category_id]])]),e("div",null,[X,u(e("select",{"onUpdate:modelValue":l[5]||(l[5]=a=>t.value.fandom_id=a),class:"form-input w-full"},[Y,(s(!0),i(y,null,h(f.value,a=>(s(),i("option",{key:a.id,value:a.id},p(a.name),9,Z))),128))],512),[[k,t.value.fandom_id]])]),e("div",null,[ee,e("div",ae,[n.value?(s(),i("img",{key:0,src:n.value,alt:"Preview",class:"w-16 h-16 object-cover rounded border"},null,8,te)):(s(),i("span",oe,"Belum ada gambar")),n.value?(s(),i("button",{key:2,type:"button",class:"btn btn-danger btn-sm",onClick:C},"Hapus")):L("",!0)]),e("input",{type:"file",accept:"image/*",onChange:V,class:"mt-2"},null,32)]),e("button",le,p(r.value?"Update Produk":"Tambah Produk"),1),j(g,{to:"/apps/product",class:"btn btn-secondary w-full mt-2"},{default:E(()=>[M("Kembali ke List")]),_:1})],40,G)])])}}});export{ne as default};
